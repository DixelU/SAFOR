# C/C++ with GCC
# Build your C/C++ project with GCC using make.
# Add steps that publish test results, save build artifacts, deploy, and more:
# https://docs.microsoft.com/azure/devops/pipelines/apps/c-cpp/gcc

trigger:
- main

pool:
  vmImage: 'windows-latest'

name: "build-check"

steps:
- script: |
    pip3 install wget
    python download_boost_fast.py
    7z x -y boost.zip
    move boost_1_76_0\boost boost
    windres --input SAFOR32.rc --output SAFOR32.res --output-format=coff --target pe-i386
    windres --input SAFOR64.rc --output SAFOR64.res --output-format=coff --target pe-x86-64
    g++ SAFOR.cpp -o SAFOR64.exe SAFOR64.res -msse2 -Ofast -m64 -std=c++17 -I"." -lcomdlg32 -luuid -luxtheme -lcomctl32 -s
    g++ SAFOR.cpp -o SAFOR32.exe SAFOR32.res -msse2 -Ofast -m32 -std=c++17 -I"." -lcomdlg32 -luuid -luxtheme -lcomctl32 -s
    dir
    mkdir SAFR 
    move SAFOR64.exe SAFR/SAFOR64.exe
    move SAFOR32.exe SAFR/SAFOR32.exe
  displayName: 'windows-build'

- task: PublishBuildArtifacts@1
  inputs:
    pathToPublish: 'SAFR'
    artifactName: SAFORs