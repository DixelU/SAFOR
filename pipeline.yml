# C/C++ with GCC
# Build your C/C++ project with GCC using make.
# Add steps that publish test results, save build artifacts, deploy, and more:
# https://docs.microsoft.com/azure/devops/pipelines/apps/c-cpp/gcc

trigger:
- main

pool:
  vmImage: 'windows-latest'

name: "build-check"

steps:
- script: |
    pip3 install wget
    python download_boost_fast.py
    7z x -y boost.zip
    move boost_1_76_0\boost boost
    g++ SAFOR.cpp -o S64.exe -DREMSUST=false -march=native -mmmx -Ofast -m64 -std=c++17 -I"." -static -lcomdlg32 -luuid -m64 -s
    g++ SAFOR.cpp -o S32.exe -DREMSUST=false -march=native -mmmx -Ofast -m32 -std=c++17 -I"." -static -lcomdlg32 -luuid -m32 -s
    g++ SAFOR.cpp -o SSR.exe -DREMSUST=true -march=native -mmmx -Ofast -m64 -std=c++17 -I"." -static -lcomdlg32 -luuid -m64 -s
    g++ SAFOR.cpp -o SAR.exe -DVELOCITYTHRESHOLDFLAG -march=native -mmmx -Ofast -m64 -std=c++17 -I"." -static -lcomdlg32 -luuid -m64 -s
    dir
    mkdir SAFR 
    move S64.exe SAFR/SAFOR64.exe
    move S32.exe SAFR/SAFOR32.exe
    move SSR.exe SAFR/SAFSOR.exe
    move SAR.exe SAFR/SAFAR.exe
  displayName: 'windows-build'

- task: PublishBuildArtifacts@1
  inputs:
    pathToPublish: 'SAFR'
    artifactName: SAFORs